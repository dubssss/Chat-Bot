<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Hello</title>
    <link rel="stylesheet" type="text/css" href="static/stylechatbot.css">
</head>
<body>
<div class="logoutbtn">
    <button>Logout</button>
</div>
<div class="chatbox">
    <div id="chatlogs" class="chatlogs">
<!--
        <div class="chat friend">
            <div class="user-photo"><img src="static/botface.jpg"></div>
                 <p class="chat-message"></p>
        </div>
        <div class="chat self">
            <div class="user-photo"><img src="static/female.jpg"></div>
                <p class="chat-message">{{msg}}</p>
        </div>
-->
    </div>
    <div class="chat-form">
        <textarea id="userreply"></textarea>
        <button id="myBtn"  onclick="getResponse()">Send</button>
    </div>
</div>
</body>
</html>

<script type="text/javascript">
    var input = document.getElementById("userreply");
    input.addEventListener("keyup", function(event) {
    if (event.keyCode === 13) {
        event.preventDefault();
        document.getElementById("myBtn").click();
    }
  });

    function getResponse(){
        let userreply= document.getElementById('userreply').value;
        document.getElementById('chatlogs').innerHTML+=`<div class="chat self">
            <div class="user-photo"><img src="static/female.jpg"></div>
            <p class="chat-message">${userreply}</p>
            </div>`;
        

    let xhr = new XMLHttpRequest();
    let url = "http://127.0.0.1:5000/processreply";
    xhr.open("POST", url, true);
    xhr.setRequestHeader("Content-Type", "application/json");
    xhr.onreadystatechange = function () {
        console.log(xhr.status)
        if (xhr.readyState === 4 && xhr.status === 200) {
            document.getElementById('chatlogs').innerHTML+= `<div class="chat friend">
            <div class="user-photo"><img src="static/botface.jpg"></div>
            <p class="chat-message">${xhr.responseText}</p>
            </div>`;
        }
    };

    var data = JSON.stringify({ "msg": userreply});
    xhr.send(data);

        /*
        if (userreply === `Hi` || userreply === `HI`|| userreply === `Hello` || userreply === `HELLO`) {
            document.getElementById('chatlogs').innerHTML+=`<div class="chat friend">
            <div class="user-photo"><img src="static/botface.jpg"></div>
                 <p class="chat-message">Hello!!!</p>
        </div>`;
        }
        else {
        document.getElementById('chatlogs').innerHTML+=`<div class="chat friend">
            <div class="user-photo"><img src="static/botface.jpg"></div>
                 <p class="chat-message">Invalid input from user</p>
        </div>`;
        }
        */
    } 
</script>
